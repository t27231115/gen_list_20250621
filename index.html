<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>年代別ヒット情報検索</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: inline-block; width: 150px; }
    select, button { margin: 5px 0; }
    #result { margin-top: 20px; }
    .section { margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>年代別ヒット情報検索</h1>

  <div class="section">
    <label for="generation">あなたの世代:</label>
    <select id="generation">
      <option value="">選択してください</option>
      <option value="10代">10代</option>
      <option value="20代">20代</option>
      <option value="30代">30代</option>
      <option value="40代">40代</option>
      <option value="50代">50代</option>
      <option value="60代">60代</option>
      <option value="70代">70代</option>
      <option value="80代">80代</option>
      <option value="90代">90代</option>
      <option value="100歳以上">100歳以上</option>
    </select>
  </div>

  <div class="section">
    <label for="searchYear">検索したい年代:</label>
    <select id="searchYear">
      <option value="">選択してください</option>
      <!-- 1900年から2024年までの選択肢 -->
    </select>
  </div>

  <button id="searchBtn">検索</button>

  <div id="result">
    <h2>検索結果</h2>
    <div id="foodSection">
      <h3>ヒット食品</h3>
      <ul id="foodList"></ul>
    </div>
    <div id="karaokeSection">
      <h3>カラオケランキング（1位～5位）</h3>
      <ol id="karaokeList"></ol>
    </div>
  </div>

  <script>
    // 年代の選択肢を生成（1900〜2024）
    const searchYearSelect = document.getElementById('searchYear');
    for (let year = 1900; year <= 2024; year++) {
      const option = document.createElement('option');
      option.value = year;
      option.textContent = year + '年';
      searchYearSelect.appendChild(option);
    }

    // サンプルデータ
    const data = {
      "1977": {
        foods: ["サッポロびん生『黒ラベル』", "ビックリマンチョコレート"],
        karaoke: [
          "渚のシンドバッド - ピンク・レディー",
          "青春時代 - 森田公一とトップギャラン",
          "ウォンテッド - ピンク・レディー",
          "勝手にしやがれ - 沢田研二",
          "昔の名前で出ています - 小林旭"
        ]
      },
      "2001": {
        foods: ["毎日骨太MBP", "本格炒め炒飯"],
        karaoke: [
          "Can You Keep A Secret? - 宇多田ヒカル",
          "M - 浜崎あゆみ",
          "PIECES OF A DREAM - CHEMISTRY",
          "波乗りジョニー - 桑田佳祐",
          "恋愛レボリューション21 - モーニング娘。"
        ]
      },
      "2024": {
        foods: ["ライラック - Mrs. GREEN APPLE", "シャルル - バルーン"],
        karaoke: [
          "ライラック - Mrs. GREEN APPLE",
          "怪獣の花唄 - Vaundy",
          "残酷な天使のテーゼ - 高橋洋子",
          "サウダージ - ポルノグラフィティ",
          "マリーゴールド - あいみょん"
        ]
      }
    };

    document.getElementById('searchBtn').addEventListener('click', () => {
      const generation = document.getElementById('generation').value;
      const searchYear = document.getElementById('searchYear').value;

      if (!generation || !searchYear) {
        alert('世代と検索したい年代を選択してください。');
        return;
      }

      const result = data[searchYear];
      const foodList = document.getElementById('foodList');
      const karaokeList = document.getElementById('karaokeList');
      foodList.innerHTML = '';
      karaokeList.innerHTML = '';

      if (result) {
        result.foods.forEach(item => {
          const li = document.createElement('li');
          li.textContent = item;
          foodList.appendChild(li);
        });
        result.karaoke.forEach(item => {
          const li = document.createElement('li');
          li.textContent = item;
          karaokeList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = 'データが見つかりません。';
        foodList.appendChild(li);
        karaokeList.appendChild(li.cloneNode(true));
      }

      // ログ送信
      const ts = new Date();
      const fmt = ts.getFullYear().toString()
        + String(ts.getMonth()+1).padStart(2,'0')
        + String(ts.getDate()).padStart(2,'0') + '_'
        + String(ts.getHours()).padStart(2,'0')
        + String(ts.getMinutes()).padStart(2,'0')
        + String(ts.getSeconds()).padStart(2,'0');

      const logData = { generation, searchYear, timestamp: fmt };
      fetch('/log', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(logData)
      }).catch(err => console.error('ログ送信エラー:', err));
    });
  </script>
</body>
</html>
